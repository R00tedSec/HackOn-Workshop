tasks:
  - name: Correct permissions on /etc/passwd (644)
    ansible.builtin.file:
      path: /etc/passwd
      owner: root
      group: root
      mode: '0644'

  - name: Correct password expiration to 365 days or less
    ansible.builtin.replace:
      path: /etc/login.defs
      after: 'PASS_MAX_DAYS'
      regexp: '^(.+)$'
      replace: '356 \1'


  - name: Ensure the only ports opened in firewall are 22 and 443
    community.general.ufw:
      state: enabled
      policy: deny

  - name: Open port 22
    community.general.ufw:
      rule: allow
      port: '22'
      proto: tcp

  - name: Open port 443
    community.general.ufw:
      rule: allow
      port: '443'
      proto: tcp